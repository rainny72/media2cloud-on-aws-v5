// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
const ColorMap = require('./colorMapping.json');

class ColorHelper {
  static findColor(rgb) {
    // check if there is a direct hit
    const hex = `#${rgb[0].toString('16')}${rgb[1].toString('16')}${rgb[2].toString('16')}`;
    if (ColorMap[hex] !== undefined) {
      return {
        ...ColorMap[hex],
        hexcode: hex,
      };
    }

    // find the closest color
    let closestHex;
    let lastDistance = Number.MAX_SAFE_INTEGER;

    for (const [key, value] of Object.entries(ColorMap)) {
      const R = value.rgb[0] - rgb[0];
      const G = value.rgb[1] - rgb[1];
      const B = value.rgb[2] - rgb[2];

      const distance = (R ** 2 + G ** 2 + B ** 2) ** 0.5;
      if (distance < lastDistance) {
        lastDistance = distance;
        closestHex = key;
      }
    }

    return {
      ...ColorMap[closestHex],
      hexcode: closestHex,
    };
  }
}

module.exports = ColorHelper;
